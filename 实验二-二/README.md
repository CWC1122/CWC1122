<div style="line-height: 1.7;"><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">1.创建项目</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/1.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">2.修改gradle文件</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/2.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">3.修改布局文件</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/3.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">4.修改String文件</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/4.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">5.编辑mainActivity的请求权限方法，并导入包</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/5-1.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/5-2.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">6.编辑startCamera方法</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/6.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">7.编辑takephoto方法，查看图库</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/7-1.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/7-2.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">8.CaptureVideo代码</div><div style="margin: 0px;"><div style="margin: 0px;">// Implements VideoCapture use case, including start and stop capturing.</div><div style="margin: 0px;">private fun captureVideo() {</div><div style="margin: 0px;">&nbsp; &nbsp;val videoCapture = this.videoCapture ?: return</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp; &nbsp;viewBinding.videoCaptureButton.isEnabled = false</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp; &nbsp;val curRecording = recording</div><div style="margin: 0px;">&nbsp; &nbsp;if (curRecording != null) {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;// Stop the current recording session.</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;curRecording.stop()</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;recording = null</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;return</div><div style="margin: 0px;">&nbsp; &nbsp;}</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp; &nbsp;// create and start a new recording session</div><div style="margin: 0px;">&nbsp; &nbsp;val name = SimpleDateFormat(FILENAME_FORMAT, Locale.US)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .format(System.currentTimeMillis())</div><div style="margin: 0px;">&nbsp; &nbsp;val contentValues = ContentValues().apply {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;put(MediaStore.MediaColumns.DISPLAY_NAME, name)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;put(MediaStore.MediaColumns.MIME_TYPE, "video/mp4")</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.P) {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;put(MediaStore.Video.Media.RELATIVE_PATH, "Movies/CameraX-Video")</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp;}</div><div style="margin: 0px;"><br /></div><div style="margin: 0px;">&nbsp; &nbsp;val mediaStoreOutputOptions = MediaStoreOutputOptions</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;.Builder(contentResolver, MediaStore.Video.Media.EXTERNAL_CONTENT_URI)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;.setContentValues(contentValues)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;.build()</div><div style="margin: 0px;">&nbsp; &nbsp;recording = videoCapture.output</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;.prepareRecording(this, mediaStoreOutputOptions)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;.apply {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (PermissionChecker.checkSelfPermission(this@MainActivity,</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Manifest.permission.RECORD_AUDIO) ==</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PermissionChecker.PERMISSION_GRANTED)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;withAudioEnabled()</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;.start(ContextCompat.getMainExecutor(this)) { recordEvent -&gt;</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;when(recordEvent) {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is VideoRecordEvent.Start -&gt; {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;viewBinding.videoCaptureButton.apply {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text = getString(R.string.stop_capture)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;isEnabled = true</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;is VideoRecordEvent.Finalize -&gt; {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!recordEvent.hasError()) {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;val msg = "Video capture succeeded: " +</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"${recordEvent.outputResults.outputUri}"</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Toast.makeText(baseContext, msg, Toast.LENGTH_SHORT)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .show()</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Log.d(TAG, msg)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recording?.close()</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;recording = null</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Log.e(TAG, "Video capture ends with error: " +</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"${recordEvent.error}")</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;viewBinding.videoCaptureButton.apply {</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;text = getString(R.string.start_capture)</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;isEnabled = true</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">&nbsp; &nbsp; &nbsp; &nbsp;}</div><div style="margin: 0px;">}</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px;"><br /></div></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><br /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;">9.保存录像到图库</div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><img src="https://github.com/CWC1122/CWC1122/blob/main/%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E4%BA%8C/images/9.png" /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><br /></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"></div><div style="color: rgb(0, 0, 0); font-family: Arial; font-size: 14px; margin: 0px;"><br /></div></div>